- name: Metallb | Check if outputss dir exists
  stat: "path={{ role_path }}/outputs"
  register: outputs_dir_exists

- name: Metallb | Make sure the known hosts dir exists
  file:
    path: "{{ role_path }}/outputs"
    state: directory
  when: not outputs_dir_exists.stat.exists

- name: Metallb | Define Templates
  set_fact:
    metallb_templates:
      - { name: 00-namespace, file: 00-namespace.yaml }
      - { name: helm-values, file: values.yaml }

- name: Metallb | Create Templates
  template:
    src: "{{ item.file }}.j2"
    dest: "{{ role_path }}/outputs/{{ item.file }}"
  with_items: "{{ metallb_templates }}"
  register: metallb_templates_output